<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shooting Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #000;
            color: #fff;
            overflow: hidden;
        }
        canvas {
            background-color: #222;
            border: 2px solid #fff;
        }
        #scoreBoard {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 18px;
        }
    </style>
</head>
<body>

<canvas id="gameCanvas" width="800" height="600"></canvas>
<div id="scoreBoard">Score: <span id="score">0</span></div>

<script>
    // Setup the canvas
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const scoreDisplay = document.getElementById('score');

    // Game settings
    let score = 0;
    let gameOver = false;
    const playerSpeed = 7;
    const bulletSpeed = 5;
    const enemySpeed = 2;

    // Player object
    const player = {
        width: 50,
        height: 20,
        x: canvas.width / 2 - 25,
        y: canvas.height - 40,
        speed: playerSpeed,
        dx: 0
    };

    // Bullets array
    const bullets = [];

    // Enemies array
    const enemies = [];

    // Key press event listeners
    document.addEventListener('keydown', keyDownHandler);
    document.addEventListener('keyup', keyUpHandler);

    // Mobile touch controls
    canvas.addEventListener('touchstart', handleTouchStart);
    canvas.addEventListener('touchmove', handleTouchMove);
    canvas.addEventListener('touchend', shootBullet);

    // Initialize touch variables
    let touchStartX = 0;

    // Create bullet function
    function shootBullet() {
        bullets.push({
            x: player.x + player.width / 2 - 2.5,
            y: player.y,
            width: 5,
            height: 10
        });
    }

    // Create enemy function
    function createEnemy() {
        const x = Math.random() * (canvas.width - 50);
        enemies.push({
            x: x,
            y: -50,
            width: 50,
            height: 30
        });
    }

    // Handle key down event
    function keyDownHandler(event) {
        if (event.key === 'ArrowRight') {
            player.dx = player.speed;
        } else if (event.key === 'ArrowLeft') {
            player.dx = -player.speed;
        } else if (event.key === ' ') {
            shootBullet();
        }
    }

    // Handle key up event
    function keyUpHandler(event) {
        if (event.key === 'ArrowRight' || event.key === 'ArrowLeft') {
            player.dx = 0;
        }
    }

    // Touch event handlers for mobile
    function handleTouchStart(event) {
        touchStartX = event.touches[0].clientX;
    }

    function handleTouchMove(event) {
        const touchX = event.touches[0].clientX;
        const dx = touchX - touchStartX;
        player.x += dx / 10; // Adjust the movement sensitivity for mobile
        touchStartX = touchX; // Update the starting point for the next move
    }

    // Update player position
    function movePlayer() {
        player.x += player.dx;
        // Boundaries for the player
        if (player.x < 0) player.x = 0;
        if (player.x + player.width > canvas.width) player.x = canvas.width - player.width;
    }

    // Move bullets
    function moveBullets() {
        bullets.forEach((bullet, index) => {
            bullet.y -= bulletSpeed;
            // Remove bullet if it goes off screen
            if (bullet.y + bullet.height < 0) {
                bullets.splice(index, 1);
            }
        });
    }

    // Move enemies
    function moveEnemies() {
        enemies.forEach((enemy, index) => {
            enemy.y += enemySpeed;
            // End game if an enemy reaches the bottom
            if (enemy.y + enemy.height > canvas.height) {
                gameOver = true;
            }
        });
    }

    // Check for collisions between bullets and enemies
    function checkCollisions() {
        bullets.forEach((bullet, bulletIndex) => {
            enemies.forEach((enemy, enemyIndex) => {
                if (
                    bullet.x < enemy.x + enemy.width &&
                    bullet.x + bullet.width > enemy.x &&
                    bullet.y < enemy.y + enemy.height &&
                    bullet.height + bullet.y > enemy.y
                ) {
                    // Remove both the bullet and the enemy
                    bullets.splice(bulletIndex, 1);
                    enemies.splice(enemyIndex, 1);
                    // Increase score
                    score++;
                    scoreDisplay.textContent = score;
                }
            });
        });
    }

    // Draw player
    function drawPlayer() {
        ctx.fillStyle = '#00f';
        ctx.fillRect(player.x, player.y, player.width, player.height);
    }

    // Draw bullets
    function drawBullets() {
        ctx.fillStyle = '#f00';
        bullets.forEach(bullet => {
            ctx.fillRect(bullet.x, bullet.y, bullet.width, bullet.height);
        });
    }

    // Draw enemies
    function drawEnemies() {
        ctx.fillStyle = '#0f0';
        enemies.forEach(enemy => {
            ctx.fillRect(enemy.x, enemy.y, enemy.width, enemy.height);
        });
    }

    // Clear the canvas
    function clearCanvas() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
    }

    // Main game loop
    function gameLoop() {
        if (!gameOver) {
            clearCanvas();
            movePlayer();
            moveBullets();
            moveEnemies();
            checkCollisions();
            drawPlayer();
            drawBullets();
            drawEnemies();
            requestAnimationFrame(gameLoop);
        } else {
            endGame();
        }
    }

    // End the game
    function endGame() {
        ctx.font = '30px Arial';
        ctx.fillStyle = '#fff';
        ctx.fillText('Game Over', canvas.width / 2 - 80, canvas.height / 2);
    }

    // Start the game
    setInterval(createEnemy, 1000); // Spawn a new enemy every second
    gameLoop();
</script>

</body>
</html>
