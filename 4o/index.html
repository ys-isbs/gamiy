<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2D Fighting Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: Arial, sans-serif;
            background-color: #000;
            color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }
        #gameCanvas {
            background-color: #333;
            width: 100vw;
            height: 80vh;
        }
        #controls {
            width: 100vw;
            display: flex;
            justify-content: space-between;
            padding: 10px;
            color: #fff;
        }
        #controls div {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #controls button {
            margin: 5px;
            padding: 10px;
            font-size: 18px;
            cursor: pointer;
        }
        .healthBar {
            width: 100px;
            height: 20px;
            background-color: red;
        }
    </style>
</head>
<body>

<canvas id="gameCanvas"></canvas>

<div id="controls">
    <div>
        <p>Player 1 Health</p>
        <div class="healthBar" id="healthP1"></div>
    </div>
    <div>
        <p>Player 2 Health</p>
        <div class="healthBar" id="healthP2"></div>
    </div>
</div>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    // Player health elements
    const healthP1 = document.getElementById('healthP1');
    const healthP2 = document.getElementById('healthP2');

    // Game settings
    const gravity = 1;
    const groundLevel = canvas.height - 100;
    const playerWidth = 50;
    const playerHeight = 100;
    let gameOver = false;

    // Player setup
    class Player {
        constructor(x, color, controls) {
            this.x = x;
            this.y = groundLevel;
            this.width = playerWidth;
            this.height = playerHeight;
            this.color = color;
            this.health = 100;
            this.isJumping = false;
            this.isBlocking = false;
            this.controls = controls;
            this.velocity = { x: 0, y: 0 };
        }

        draw() {
            ctx.fillStyle = this.color;
            ctx.fillRect(this.x, this.y, this.width, this.height);
        }

        move() {
            // Apply gravity
            this.velocity.y += gravity;
            this.y += this.velocity.y;

            // Prevent player from falling below the ground
            if (this.y > groundLevel) {
                this.y = groundLevel;
                this.isJumping = false;
            }

            // Move horizontally
            this.x += this.velocity.x;

            // Boundaries check
            if (this.x < 0) this.x = 0;
            if (this.x + this.width > canvas.width) this.x = canvas.width - this.width;
        }

        // Health management
        takeDamage(amount) {
            if (!this.isBlocking) {
                this.health -= amount;
                if (this.health <= 0) {
                    this.health = 0;
                    gameOver = true;
                }
            }
        }

        // Update health bar
        updateHealthBar() {
            if (this.controls.player === 1) {
                healthP1.style.width = this.health + 'px';
            } else {
                healthP2.style.width = this.health + 'px';
            }
        }
    }

    // Player controls
    const player1Controls = {
        left: 'a',
        right: 'd',
        jump: 'w',
        punch: 'f',
        kick: 'g',
        block: 'h',
        player: 1
    };

    const player2Controls = {
        left: 'ArrowLeft',
        right: 'ArrowRight',
        jump: 'ArrowUp',
        punch: 'k',
        kick: 'l',
        block: ';',
        player: 2
    };

    // Initialize players
    const player1 = new Player(100, 'blue', player1Controls);
    const player2 = new Player(canvas.width - 150, 'red', player2Controls);

    // Track keys being pressed
    const keys = {};

    document.addEventListener('keydown', (e) => {
        keys[e.key] = true;
    });

    document.addEventListener('keyup', (e) => {
        keys[e.key] = false;
    });

    // Handle player actions
    function handlePlayerActions() {
        // Player 1 actions
        if (keys[player1.controls.left]) player1.velocity.x = -5;
        else if (keys[player1.controls.right]) player1.velocity.x = 5;
        else player1.velocity.x = 0;

        if (keys[player1.controls.jump] && !player1.isJumping) {
            player1.velocity.y = -15;
            player1.isJumping = true;
        }

        if (keys[player1.controls.block]) player1.isBlocking = true;
        else player1.isBlocking = false;

        // Player 2 actions
        if (keys[player2.controls.left]) player2.velocity.x = -5;
        else if (keys[player2.controls.right]) player2.velocity.x = 5;
        else player2.velocity.x = 0;

        if (keys[player2.controls.jump] && !player2.isJumping) {
            player2.velocity.y = -15;
            player2.isJumping = true;
        }

        if (keys[player2.controls.block]) player2.isBlocking = true;
        else player2.isBlocking = false;

        // Combat logic: Punch and kick detection
        if (keys[player1.controls.punch] && isColliding(player1, player2)) {
            player2.takeDamage(10);
        }
        if (keys[player1.controls.kick] && isColliding(player1, player2)) {
            player2.takeDamage(15);
        }

        if (keys[player2.controls.punch] && isColliding(player2, player1)) {
            player1.takeDamage(10);
        }
        if (keys[player2.controls.kick] && isColliding(player2, player1)) {
            player1.takeDamage(15);
        }
    }

    // Collision detection
    function isColliding(playerA, playerB) {
        return (
            playerA.x < playerB.x + playerB.width &&
            playerA.x + playerA.width > playerB.x &&
            playerA.y < playerB.y + playerB.height &&
            playerA.y + playerA.height > playerB.y
        );
    }

    // Update game state
    function updateGame() {
        if (!gameOver) {
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Handle actions
            handlePlayerActions();

            // Move and draw players
            player1.move();
            player2.move();
            player1.draw();
            player2.draw();

            // Update health bars
            player1.updateHealthBar();
            player2.updateHealthBar();

            // Check for game over
            if (gameOver) {
                ctx.font = '40px Arial';
                ctx.fillStyle = '#fff';
                ctx.fillText(
                    `${player1.health <= 0 ? 'Player 2' : 'Player 1'} Wins!`,
                    canvas.width / 2 - 100,
                    canvas.height / 2
                );
            } else {
                requestAnimationFrame(updateGame);
            }
        }
    }

    // Start the game loop
    updateGame();
</script>

</body>
</html>
