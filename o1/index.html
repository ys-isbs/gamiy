<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Atari Ping Pong</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        /* Reset default styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Body styling */
        body {
            background-color: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
            font-family: Arial, sans-serif;
            position: relative;
        }

        /* Game Canvas */
        canvas {
            background-color: #111;
            border: 2px solid #fff;
            border-radius: 10px;
        }

        /* Score Display */
        #scoreBoard {
            position: absolute;
            top: 20px;
            width: 100%;
            text-align: center;
            color: #fff;
            font-size: 24px;
            z-index: 1;
        }

        /* Start/Restart Button */
        #startButton {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #fff;
            color: #000;
            border: none;
            padding: 15px 30px;
            font-size: 20px;
            border-radius: 5px;
            cursor: pointer;
            z-index: 2;
        }

        #startButton:hover {
            background-color: #ddd;
        }

        /* Mobile Controls */
        .control-button {
            position: absolute;
            bottom: 20px;
            width: 60px;
            height: 60px;
            background-color: rgba(255, 255, 255, 0.7);
            border: none;
            border-radius: 50%;
            font-size: 30px;
            cursor: pointer;
            display: none; /* Hidden on desktop */
            align-items: center;
            justify-content: center;
        }

        /* Show controls on touch devices */
        @media (pointer: coarse) {
            .control-button {
                display: flex;
            }
        }

        /* Positioning Mobile Control Buttons */
        #leftButton {
            left: 20px;
        }

        #rightButton {
            left: 100px;
        }
    </style>
</head>
<body>
    <!-- Score Display -->
    <div id="scoreBoard">Player 1: 0 | Player 2: 0</div>

    <!-- Start/Restart Button -->
    <button id="startButton">Start Game</button>

    <!-- Game Canvas -->
    <canvas id="gameCanvas" width="800" height="600"></canvas>

    <!-- Mobile Control Buttons -->
    <button id="leftButton" class="control-button">◀</button>
    <button id="rightButton" class="control-button">▶</button>

    <script>
        // Get DOM Elements
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreBoard = document.getElementById('scoreBoard');
        const startButton = document.getElementById('startButton');
        const leftButton = document.getElementById('leftButton');
        const rightButton = document.getElementById('rightButton');

        // Game Variables
        let animationId;
        let isGameRunning = false;

        // Scores
        let scorePlayer1 = 0;
        let scorePlayer2 = 0;

        // Paddle Class
        class Paddle {
            constructor(x, y, width, height, color, upKey, downKey) {
                this.x = x;
                this.y = y;
                this.width = width;
                this.height = height;
                this.color = color;
                this.speed = 7;
                this.moveUp = false;
                this.moveDown = false;
                this.touchMoveLeft = false;
                this.touchMoveRight = false;
            }

            draw() {
                ctx.fillStyle = this.color;
                ctx.fillRect(this.x, this.y, this.width, this.height);
            }

            update() {
                if (this.moveUp) {
                    this.y -= this.speed;
                }
                if (this.moveDown) {
                    this.y += this.speed;
                }

                // Prevent paddle from going out of bounds
                if (this.y < 0) this.y = 0;
                if (this.y + this.height > canvas.height) this.y = canvas.height - this.height;
            }

            // For Mobile Controls
            mobileMove(direction) {
                if (direction === 'left') {
                    this.y -= this.speed;
                } else if (direction === 'right') {
                    this.y += this.speed;
                }

                // Prevent paddle from going out of bounds
                if (this.y < 0) this.y = 0;
                if (this.y + this.height > canvas.height) this.y = canvas.height - this.height;
            }
        }

        // Ball Class
        class Ball {
            constructor(x, y, radius, color) {
                this.x = x;
                this.y = y;
                this.radius = radius;
                this.color = color;
                this.speed = 5;
                this.velocityX = this.speed;
                this.velocityY = this.speed;
            }

            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
                ctx.closePath();
            }

            update(paddle1, paddle2) {
                this.x += this.velocityX;
                this.y += this.velocityY;

                // Top and Bottom Collision
                if (this.y - this.radius < 0 || this.y + this.radius > canvas.height) {
                    this.velocityY = -this.velocityY;
                }

                // Paddle Collision
                if (this.x - this.radius < paddle1.x + paddle1.width &&
                    this.y > paddle1.y &&
                    this.y < paddle1.y + paddle1.height) {
                    this.velocityX = -this.velocityX;
                    this.x = paddle1.x + paddle1.width + this.radius; // Prevent sticking
                }

                if (this.x + this.radius > paddle2.x &&
                    this.y > paddle2.y &&
                    this.y < paddle2.y + paddle2.height) {
                    this.velocityX = -this.velocityX;
                    this.x = paddle2.x - this.radius; // Prevent sticking
                }

                // Left and Right Goals
                if (this.x - this.radius < 0) {
                    scorePlayer2++;
                    updateScore();
                    resetBall();
                }

                if (this.x + this.radius > canvas.width) {
                    scorePlayer1++;
                    updateScore();
                    resetBall();
                }
            }
        }

        // Initialize Paddles and Ball
        const paddleWidth = 20;
        const paddleHeight = 100;
        const paddle1 = new Paddle(30, canvas.height / 2 - paddleHeight / 2, paddleWidth, paddleHeight, '#fff', 'w', 's');
        const paddle2 = new Paddle(canvas.width - 30 - paddleWidth, canvas.height / 2 - paddleHeight / 2, paddleWidth, paddleHeight, '#fff', 'ArrowUp', 'ArrowDown');
        const ball = new Ball(canvas.width / 2, canvas.height / 2, 10, '#fff');

        // Update Score Display
        function updateScore() {
            scoreBoard.textContent = `Player 1: ${scorePlayer1} | Player 2: ${scorePlayer2}`;
        }

        // Reset Ball to Center
        function resetBall() {
            ball.x = canvas.width / 2;
            ball.y = canvas.height / 2;
            // Randomize initial direction
            ball.velocityX = ball.speed * (Math.random() > 0.5 ? 1 : -1);
            ball.velocityY = ball.speed * (Math.random() > 0.5 ? 1 : -1);
        }

        // Handle Keyboard Input
        const keys = {};

        window.addEventListener('keydown', function(e) {
            keys[e.code] = true;
            // Prevent default scrolling for arrow keys and space
            if(['ArrowUp','ArrowDown','Space'].includes(e.code)) {
                e.preventDefault();
            }
        });

        window.addEventListener('keyup', function(e) {
            keys[e.code] = false;
        });

        // Handle Mobile Button Presses
        leftButton.addEventListener('touchstart', function(e) {
            e.preventDefault();
            paddle1.mobileMove('left');
        });

        rightButton.addEventListener('touchstart', function(e) {
            e.preventDefault();
            paddle1.mobileMove('right');
        });

        // Main Game Loop
        function gameLoop() {
            // Clear Canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Update Paddles based on keys
            if (keys['ArrowUp'] || keys['KeyW']) {
                paddle1.moveUp = true;
            } else {
                paddle1.moveUp = false;
            }

            if (keys['ArrowDown'] || keys['KeyS']) {
                paddle1.moveDown = true;
            } else {
                paddle1.moveDown = false;
            }

            if (keys['ArrowUp']) {
                paddle2.moveUp = true;
            } else {
                paddle2.moveUp = false;
            }

            if (keys['ArrowDown']) {
                paddle2.moveDown = true;
            } else {
                paddle2.moveDown = false;
            }

            // Update and Draw Paddles
            paddle1.update();
            paddle2.update();
            paddle1.draw();
            paddle2.draw();

            // Update and Draw Ball
            ball.update(paddle1, paddle2);
            ball.draw();

            // Continue the loop
            animationId = requestAnimationFrame(gameLoop);
        }

        // Start Game
        startButton.addEventListener('click', function() {
            if (!isGameRunning) {
                isGameRunning = true;
                startButton.style.display = 'none';
                resetBall();
                gameLoop();
            } else {
                // Restart the game
                scorePlayer1 = 0;
                scorePlayer2 = 0;
                updateScore();
                resetBall();
            }
        });

        // Initialize Score
        updateScore();

        // Prevent scrolling on touch devices when using controls
        window.addEventListener('touchmove', function(e) {
            e.preventDefault();
        }, { passive: false });

        // Responsive Canvas
        function resizeCanvas() {
            const aspectRatio = 4 / 3;
            let width = window.innerWidth;
            let height = window.innerHeight;

            if (width / height > aspectRatio) {
                width = height * aspectRatio;
            } else {
                height = width / aspectRatio;
            }

            canvas.style.width = `${width * 0.9}px`;
            canvas.style.height = `${height * 0.9}px`;
        }

        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();
    </script>
</body>
</html>
